# ðŸ”® Oracle Stable Diffusion Troubleshooting Guide

## CORS Issue: "Access to fetch at 'http://127.0.0.1:7860/sdapi/v1/options' has been blocked by CORS policy"

This is the most common issue when connecting Oracle to your local Stable Diffusion setup. Here's how to fix it:

### Step 1: Update your Stable Diffusion launch parameters

1. **Create a new `webui-user.bat` file** in your Stable Diffusion directory with these contents:

```batch
@echo off
set COMMANDLINE_ARGS=--api --listen --port 7860 --cors-allow-origins=http://localhost:5173 --skip-torch-cuda-test --precision full --no-half
echo ==============================================
echo ORACLE STABLE DIFFUSION LAUNCHER
echo ==============================================
echo.
call webui.bat
```

2. **Place this file** in your Stable Diffusion directory: `G:\stable-diffusion-webui-directml\`

3. **Close any running** Stable Diffusion instances

4. **Run the new `webui-user.bat`** to start Stable Diffusion with CORS properly enabled

### Step 2: Verify your Vite proxy settings

The file `vite.config.ts` should contain this proxy configuration:

```typescript
server: {
  proxy: {
    '/sdapi': {
      target: 'http://127.0.0.1:7860',
      changeOrigin: true,
      secure: false,
    },
  },
},
```

### Step 3: Test with a simple API request

1. Open your browser to: `http://localhost:5173/sdapi/v1/options`
2. You should see JSON data from your Stable Diffusion server
3. If you see a blank page or error, the proxy isn't working

### Step 4: Fix firewall issues (if needed)

If you still have connection problems, it might be a firewall issue:

1. Open Windows Defender Firewall
2. Click "Allow an app or feature through Windows Defender Firewall"
3. Click "Change settings" and then "Allow another app..."
4. Browse to your Stable Diffusion executable and add it
5. Make sure both Private and Public are checked

### Step 5: Advanced debugging

If you're still having issues:

1. Try using the `--api-log` flag in your `webui-user.bat` to see detailed API logs
2. Check your browser's developer console (F12) for network errors
3. Try accessing the Stable Diffusion API directly at `http://127.0.0.1:7860/docs` to verify it's working

## Model Issues: "No images generated by local Stable Diffusion"

If the connection works but you can't generate images:

1. Make sure your models are in the right location: `G:\stable-diffusion-webui-directml\models\Stable-diffusion\`
2. Verify the model names match what Oracle expects:
   - `oracle-pristine.safetensors`
   - `oracle-cryptic.safetensors`
   - `oracle-glitched.safetensors`
   - `oracle-forbidden.safetensors`

3. Try generating a test image directly in the Stable Diffusion Web UI

## Performance Optimization for AMD RX 6800 XT

For your 16GB AMD card, try these optimized settings:

```batch
set COMMANDLINE_ARGS=--api --listen --port 7860 --cors-allow-origins=http://localhost:5173 --xformers --opt-split-attention --no-half-vae
```

This should give you fast generation (2-4 seconds per image) with your high-end card.

## Still having issues?

If you've tried everything above and still can't get it working:

1. **Try restarting both** your Oracle app and Stable Diffusion
2. **Check if your antivirus** might be blocking connections
3. **Try using** `localhost` instead of `127.0.0.1` in all URLs
4. **Temporarily disable** Windows Defender Firewall to test if that's the issue 